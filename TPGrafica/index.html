<!DOCTYPE html>
<html lang="en">
<head>
  <title>TP - Grafica</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
  <link rel="stylesheet" type="text/css" href="css/style.css">
</head>

<body>
  
  <script src="js/jquery-3.2.1.min.js"></script>
  <script src="../build/three.js"></script>
  <script src="js/controls/OrbitControls.js"></script>
  <script src="js/renderers/Projector.js"></script>

  <script src="scene0.js"></script>
  <script src="scene1.js"></script>
  <script src="scene2.js"></script>
  <script src="functions.js"></script>

  <script>
    var controls, camera, scene, renderer;
    var mainCamera, containerScene;
    

    init();
    animate();
    
    function init() {
      // CAMERAS ============================================
      camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 100000);
      camera.position.set(0, 0, 1000);
      camera.name = "camera";
      
      mainCamera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 1, 100000);
      mainCamera.name = "mainCamera";

      controls = new THREE.OrbitControls(camera);
      controls.minDistance = 500;
      controls.maxDistance = 2500;
      controls.name ="controls";
      // ======================================================


      // SCENE ============================================
      scene = new THREE.Scene();
      scene.name ="scene";
      containerScene = new THREE.Scene();
      containerScene.name ="containerScene";
      // ======================================================


      // Lights ============================================
      var ambient = new THREE.AmbientLight(0xffffff);
      scene.add(ambient);
      // ======================================================

      // Textures ============================================
      containerScene.add(skyMesh);
      // ======================================================         

      addElementsToScene(vMesh0,containerScene);    
      
      // Async text ===========================================
      $( document ).ready(function() {
        console.log( "ready!" );
        addTextScene0();
      });
      // ======================================================
      
      //RENDER  =============================================
      renderer = new THREE.WebGLRenderer();
      renderer.autoClear = false;
      renderer.setPixelRatio(window.devicePixelRatio);
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setFaceCulling(THREE.CullFaceNone);
      document.body.appendChild(renderer.domElement);
      // ======================================================

      window.addEventListener('resize', onWindowResize, false);
      window.addEventListener('click', onClicking, false );

      raycaster = new THREE.Raycaster();
      mouseVector = new THREE.Vector2();    
    }

    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();

      mainCamera.aspect = window.innerWidth / window.innerHeight;
      mainCamera.updateProjectionMatrix();

      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function animate() {
      requestAnimationFrame(animate);
      render();
    }

    function render() {
      camera.lookAt(scene.position);
      mainCamera.rotation.copy(camera.rotation);

      renderer.render(containerScene, mainCamera);
      // renderer.render(scene, camera);
    }

  </script>

</body>

</html>